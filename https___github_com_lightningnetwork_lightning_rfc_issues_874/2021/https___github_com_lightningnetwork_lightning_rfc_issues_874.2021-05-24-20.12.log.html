<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<title>#lightning-dev log</title>
<style type="text/css">
/* For the .log.html */
pre { /*line-height: 125%;*/
      white-space: pre-wrap; }
body { background: #f0f0f0; }

body .tm  { color: #007020 }                      /* time */
body .nk  { color: #062873; font-weight: bold }   /* nick, regular */
body .nka { color: #007020; font-weight: bold }  /* action nick */
body .ac  { color: #00A000 }                      /* action line */
body .hi  { color: #4070a0 }                 /* hilights */
/* Things to make particular MeetBot commands stick out */
body .topic     { color: #007020; font-weight: bold }
body .topicline { color: #000080; font-weight: bold }
body .cmd       { color: #007020; font-weight: bold }
body .cmdline  { font-weight: bold }

</style>
</head>

<body>
<pre><a name="l-1"></a><span class="tm">20:12:12</span><span class="nk"> &lt;rusty&gt;</span> <span class="cmd">#startmeeting </span><span class="cmdline">https://github.com/lightningnetwork/lightning-rfc/issues/874</span>
<a name="l-2"></a><span class="tm">20:12:12</span><span class="nk"> &lt;lndev-bot&gt;</span> Meeting started Mon May 24 20:12:12 2021 UTC and is due to finish in 60 minutes.  The chair is rusty. Information about MeetBot at http://wiki.debian.org/MeetBot.
<a name="l-3"></a><span class="tm">20:12:12</span><span class="nk"> &lt;lndev-bot&gt;</span> Useful Commands: #action #agreed #help #info #idea #link #topic #startvote.
<a name="l-4"></a><span class="tm">20:12:12</span><span class="nk"> &lt;lndev-bot&gt;</span> The meeting name has been set to 'https___github_com_lightningnetwork_lightning_rfc_issues_874'
<a name="l-5"></a><span class="tm">20:12:51</span><span class="nk"> &lt;rusty&gt;</span> <span class="topic">#topic </span><span class="topicline">https://github.com/lightningnetwork/lightning-rfc/pull/872</span>
<a name="l-6"></a><span class="tm">20:13:30</span><span class="nk"> &lt;rusty&gt;</span> Ouch, roasbeef I hadn't seen this before.
<a name="l-7"></a><span class="tm">20:14:06</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">rusty:</span> yeh something we ran into a while ago, but didn't know what was up, then the launch of our new node analysis thingy ended up triggering it w/ the ACINQ node, and we dug in exchanging error info till we found it
<a name="l-8"></a><span class="tm">20:14:29 </span><span class="nka">* rusty</span> <span class="ac">wonders what c-lightning does, but fortunately with those test vectors I know I'm going to find out today.</span>
<a name="l-9"></a><span class="tm">20:14:30</span><span class="nk"> &lt;roasbeef&gt;</span> mpp kinda causes it to occur more often since the payhash is always re-used
<a name="l-10"></a><span class="tm">20:14:40</span><span class="nk"> &lt;roasbeef&gt;</span> and if you split in half, then the amts may be the same more often
<a name="l-11"></a><span class="tm">20:14:55</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">rusty:</span> I checked and iirc CL does msat
<a name="l-12"></a><span class="tm">20:15:11</span><span class="nk"> &lt;roasbeef&gt;</span> assuming this is where the sorting happens: https://github.com/ElementsProject/lightning/blob/ade10e7fc4dacbb9d635b05152c7dc38c0896ce7/common/permute_tx.c#L138
<a name="l-13"></a><span class="tm">20:15:15</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">roasbeef:</span> yeah, that would be the "obvious" approach. And wrong ofc.
<a name="l-14"></a><span class="tm">20:15:16</span><span class="nk"> &lt;roasbeef&gt;</span> err does sat*
<a name="l-15"></a><span class="tm">20:15:27</span><span class="nk"> &lt;BlueMatt&gt;</span> I believe we do sat
<a name="l-16"></a><span class="tm">20:16:03</span><span class="nk"> &lt;rusty&gt;</span> I mean.  Of course we do it correctly! Yeah!  Go us!  (Meh, only because we post-sort the tx after construction, so bullet dodged)
<a name="l-17"></a><span class="tm">20:16:48</span><span class="nk"> &lt;roasbeef&gt;</span> yeh small fix which is nice, hard to know how many force closes over the past few years have happened because of this
<a name="l-18"></a><span class="tm">20:16:53</span><span class="nk"> &lt;roasbeef&gt;</span> acinq has a fix up on their end
<a name="l-19"></a><span class="tm">20:17:06</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> I thought there was a proposal to spell out and not just refer to BIP 69.  Maybe it got lost in the backlog?
<a name="l-20"></a><span class="tm">20:17:07</span><span class="nk"> &lt;roasbeef&gt;</span> which has been merged
<a name="l-21"></a><span class="tm">20:17:28</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> I dunno, I've complained about that a few times, but I think I've always just been loud and annoying and never done the work to fix it
<a name="l-22"></a><span class="tm">20:17:48</span><span class="nk"> &lt;midnight&gt;</span> fwiw, I have a reliable report of the new owner who has now direct control over the infrastructure, breaking into an email account and a slack server. Additionally, pointers in /topic which state the channel as moved to libera, Lee is directly using as justification for channel takeover. New staff who have demonstrated fairly extreme hostility (even for our sensibilities) are now invading/joining
<a name="l-23"></a><span class="tm">20:18:02</span><span class="nk"> &lt;midnight&gt;</span> channels, and Freenode infrastructure and services are being replaced. Why are they being replaced? Who knows.
<a name="l-24"></a><span class="tm">20:18:41</span><span class="nk"> &lt;rusty&gt;</span> OK, I do not know how to ack #872 hard enough.  Would like to test the vectors though: assuming they pass, everyone happy with applying?
<a name="l-25"></a><span class="tm">20:19:18</span><span class="nk"> &lt;BlueMatt&gt;</span> if we're fixing it for the 3rd time now I'd kinda prefer we finally actually drop the BIP 69 reference and be self-contained, but, yea, looks good.
<a name="l-26"></a><span class="tm">20:19:26</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">rusty:</span> added some test vectors from pierre to include the msat rounding
<a name="l-27"></a><span class="tm">20:19:52</span><span class="nk"> &lt;midnight&gt;</span> Apologies, I didn't see the meeting start.
<a name="l-28"></a><span class="tm">20:19:55</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">roasbeef:</span> yeah, I just wanna incorporate them in the c-lightning vector tests.  Should only take me 10 minutes.
<a name="l-29"></a><span class="tm">20:20:05</span><span class="nk"> &lt;BlueMatt&gt;</span> thanks for context either way, midnight
<a name="l-30"></a><span class="tm">20:20:09</span><span class="nk"> &lt;midnight&gt;</span> \o
<a name="l-31"></a><span class="tm">20:20:34</span><span class="nk"> &lt;rusty&gt;</span> <span class="cmd">#action </span><span class="cmdline">BlueMatt to create PR to excise BIP-69 references in favor of explicit ordering requirements.</span>
<a name="l-32"></a><span class="tm">20:21:01</span><span class="nk"> &lt;rusty&gt;</span> OK, so seems like we have consensus?  Any objections to applying #872?
<a name="l-33"></a><span class="tm">20:22:05</span><span class="nk"> &lt;kanzure&gt;</span> <span class="hi">BlueMatt:</span> i do logging
<a name="l-34"></a><span class="tm">20:22:28</span><span class="nk"> &lt;kanzure&gt;</span> at least the one in the /topic
<a name="l-35"></a><span class="tm">20:22:36</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">kanzure:</span> plz2log libera
<a name="l-36"></a><span class="tm">20:22:39</span><span class="nk"> &lt;kanzure&gt;</span> just let me know where to point it to
<a name="l-37"></a><span class="tm">20:23:06</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> let me just suggest a different text for roasbeef on 872. we all know how long trivial prs lie around....
<a name="l-38"></a><span class="tm">20:23:57</span><span class="nk"> &lt;kanzure&gt;</span> will the channel be moving entirely or should i be logging both places?
<a name="l-39"></a><span class="tm">20:24:03</span><span class="nk"> &lt;kanzure&gt;</span> and if so, what is the new channel name?
<a name="l-40"></a><span class="tm">20:24:04</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> not if we pre-approve the open-coding now?  I'd rather agree to merge 872 (pending final test vector check), then pre-approve an open-coded BIP-69 replace assuming two of us sign off.
<a name="l-41"></a><span class="tm">20:24:04</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">BlueMatt:</span> which would be to essentially include the BIP 69 text?
<a name="l-42"></a><span class="tm">20:24:16</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> honestly, bip 69 is, itself, underspecified
<a name="l-43"></a><span class="tm">20:24:23</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> eh, whatever.
<a name="l-44"></a><span class="tm">20:24:29</span><span class="nk"> &lt;ariard&gt;</span> <span class="hi">kanzure:</span> i believe it's still lightning-dev
<a name="l-45"></a><span class="tm">20:24:37</span><span class="nk"> &lt;roasbeef&gt;</span> in this context, only becauase we added this tie-breaker, where else is it underspecified?
<a name="l-46"></a><span class="tm">20:25:07</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">roasbeef:</span> I believe the shorter-wins tiebreak is also unspecified in BIP-69.
<a name="l-47"></a><span class="tm">20:25:49</span><span class="nk"> &lt;roasbeef&gt;</span> gotcha, if so ofc it can be updated to make it more fully specified
<a name="l-48"></a><span class="tm">20:26:03</span><span class="nk"> &lt;rusty&gt;</span> i.e. "ab" &lt; "abc".  Which is common convention, but still needs to be spelled out.
<a name="l-49"></a><span class="tm">20:26:30</span><span class="nk"> &lt;rusty&gt;</span> It's pretty trivial tho, so I think it comes under "spelling rule", esp if we've agreed here to it?
<a name="l-50"></a><span class="tm">20:26:41</span><span class="nk"> &lt;BlueMatt&gt;</span> anyway, either https://github.com/lightningnetwork/lightning-rfc/pull/872/files#r638250523 or I'll open a new pr with that text.
<a name="l-51"></a><span class="tm">20:26:45</span><span class="nk"> &lt;BlueMatt&gt;</span> either way ack the total with that.
<a name="l-52"></a><span class="tm">20:27:34</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> Ack that change.  We can clean it up into an ordered list as a spelling fix if we want.
<a name="l-53"></a><span class="tm">20:27:46</span><span class="nk"> &lt;BlueMatt&gt;</span> right, or that.
<a name="l-54"></a><span class="tm">20:27:46</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">rusty:</span> yeh I meant update BIP 69 itself for that length case
<a name="l-55"></a><span class="tm">20:28:03</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">roasbeef:</span> yeah, but BIP-69 is DOA afaict?
<a name="l-56"></a><span class="tm">20:28:14</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> bip 69 should basically be used absolutely never anyway. so why bother updating it? :)
<a name="l-57"></a><span class="tm">20:28:27</span><span class="nk"> &lt;roasbeef&gt;</span> is it?
<a name="l-58"></a><span class="tm">20:28:40</span><span class="nk"> &lt;BlueMatt&gt;</span> yes, I think that's a pretty universally-held view that bip 69 is fundamentally a bad idea.
<a name="l-59"></a><span class="tm">20:28:43</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">BlueMatt:</span> pretty useful in practice imo, just because you don't use it doesn't mean it isn't useful...
<a name="l-60"></a><span class="tm">20:28:56</span><span class="nk"> &lt;BlueMatt&gt;</span> well, outside of lightning where you need a consistent sort order, of course
<a name="l-61"></a><span class="tm">20:29:18</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> dunno, you're literally the first person I've spoken to who is sensible on these things who has thought it was a reasonable thing in almost any context outside of lightning.
<a name="l-62"></a><span class="tm">20:29:52</span><span class="nk"> &lt;devrandom&gt;</span> the order could be pseudo-random instead?
<a name="l-63"></a><span class="tm">20:29:54</span><span class="nk"> &lt;roasbeef&gt;</span> we use it in pool as an eaxmple, useful to have a cannonical ordering in any multi-party transaction context
<a name="l-64"></a><span class="tm">20:30:11</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">devrandom:</span> yes, there is basically no reason to ever prefer sorted over random unless you're doing something like lightning
<a name="l-65"></a><span class="tm">20:30:42</span><span class="nk"> &lt;BlueMatt&gt;</span> anyway, this is quite a tangent
<a name="l-66"></a><span class="tm">20:31:05</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">roasbeef:</span> better is an order by shared secret-prefix SHA, though until taproot it's a bit pointless to try to hide IMHO?
<a name="l-67"></a><span class="tm">20:31:10</span><span class="nk"> &lt;roasbeef&gt;</span> idk make your own sorting BIP then if you don't like it, BIPs just say how things can be done, if ppl find them useful (like in thsi context), they'll use it
<a name="l-68"></a><span class="tm">20:31:11</span><span class="nk"> &lt;BlueMatt&gt;</span> (and if we ever had commitment transactions that weren't obviously-lightning I'd strongly suggest we permute the order by a shared secret)
<a name="l-69"></a><span class="tm">20:31:25</span><span class="nk"> &lt;roasbeef&gt;</span> seems this entire time, no one has cared enough to make another one
<a name="l-70"></a><span class="tm">20:31:34</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> why write a bip for the thing that all wallets that are halfway decent already do :)
<a name="l-71"></a><span class="tm">20:31:52</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">BlueMatt:</span> something something standards
<a name="l-72"></a><span class="tm">20:31:58</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> snap!  In fact, dual funding gives you this control over ordering.
<a name="l-73"></a><span class="tm">20:32:25</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> huh! good opportunity to do sorting with a shared-secret permutation?
<a name="l-74"></a><span class="tm">20:32:47</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> I'd strongly suggest we do that to avoid standing out (though i assume it doesnt matter until taproot?)
<a name="l-75"></a><span class="tm">20:33:01</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> on co-construction, you explicitly give an ordering.  So you can do whatever you want in this case.
<a name="l-76"></a><span class="tm">20:33:13</span><span class="nk"> &lt;niftynei&gt;</span> iiuc the DLC project uses the same protocol for ordering as the dual-funding proposal
<a name="l-77"></a><span class="tm">20:33:34</span><span class="nk"> &lt;BlueMatt&gt;</span> ah! hmmm, i guess sensible implementations will randomize. guess it'd be cool to just force it to be random based on some shared random values (like pubkeys that dont ever hit the chain)
<a name="l-78"></a><span class="tm">20:33:47</span><span class="nk"> &lt;BlueMatt&gt;</span> avoids one more parameter on the wire, which is also always good
<a name="l-79"></a><span class="tm">20:34:03</span><span class="nk"> &lt;ariard&gt;</span> yes we have custom inputs'serial_id in dlcs
<a name="l-80"></a><span class="tm">20:34:08</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> Naah, you may want explicit ordering for weird SIGHASH_SINGLE tricks etc.
<a name="l-81"></a><span class="tm">20:34:19</span><span class="nk"> &lt;BlueMatt&gt;</span> ohhh, hum. yuck but ok
<a name="l-82"></a><span class="tm">20:35:24</span><span class="nk"> &lt;rusty&gt;</span> Anyway, meanwhile I'm happy with Matt's text.  Simply spelling out the requirement is nice.
<a name="l-83"></a><span class="tm">20:35:56 </span><span class="nka">* BlueMatt</span> <span class="ac">has always found it confusing to have to click through to bip 69, and was confused the first time he read it and had to look up implementation details for what to do if lengths differ</span>
<a name="l-84"></a><span class="tm">20:38:20</span><span class="nk"> &lt;rusty&gt;</span> OK, so I think we're in bikeshed territory?  Let's hash it out on issue, and apply it with or without Matt's reword.  I'd rather not block it on tangential rewording.
<a name="l-85"></a><span class="tm">20:38:34</span><span class="nk"> &lt;roasbeef&gt;</span> it's mergeable as is imo
<a name="l-86"></a><span class="tm">20:39:05</span><span class="nk"> &lt;rusty&gt;</span> <span class="cmd">#action </span><span class="cmdline">rusty Merge #872 (after validating test vectors).</span>
<a name="l-87"></a><span class="tm">20:39:28</span><span class="nk"> &lt;rusty&gt;</span> I will split Matt's change into a separate PR myself, how's that?  Then we can argue there :)
<a name="l-88"></a><span class="tm">20:39:46</span><span class="nk"> &lt;rusty&gt;</span> <span class="topic">#topic </span><span class="topicline">https://github.com/lightningnetwork/lightning-rfc/pull/672</span>
<a name="l-89"></a><span class="tm">20:40:24</span><span class="nk"> &lt;BlueMatt&gt;</span> this seems to have enough acks already?
<a name="l-90"></a><span class="tm">20:40:27</span><span class="nk"> &lt;BlueMatt&gt;</span> more than enough
<a name="l-91"></a><span class="tm">20:40:47</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> Indeed.  And we have Eclair and c-lightning tested interop on this (it's pretty trivial).  Note that c-lightning has not implemented bech32m yet, so there's no normal way for users to supply an actual v1 address.
<a name="l-92"></a><span class="tm">20:41:08</span><span class="nk"> &lt;rusty&gt;</span> Any objections to applying this?
<a name="l-93"></a><span class="tm">20:41:12</span><span class="nk"> &lt;BlueMatt&gt;</span> do it
<a name="l-94"></a><span class="tm">20:41:14</span><span class="nk"> &lt;roasbeef&gt;</span> heh yeh thought this was merged a while ago
<a name="l-95"></a><span class="tm">20:41:15</span><span class="nk"> &lt;roasbeef&gt;</span> do eet
<a name="l-96"></a><span class="tm">20:41:37</span><span class="nk"> &lt;rusty&gt;</span> <span class="cmd">#action </span><span class="cmdline">rusty to merge #672</span>
<a name="l-97"></a><span class="tm">20:42:22</span><span class="nk"> &lt;rusty&gt;</span> <span class="topic">#topic </span><span class="topicline">https://github.com/lightningnetwork/lightning-rfc/issues/873</span>
<a name="l-98"></a><span class="tm">20:42:46</span><span class="nk"> &lt;BlueMatt&gt;</span> yes, would be nice, someone's gotta do the work :/
<a name="l-99"></a><span class="tm">20:43:19</span><span class="nk"> &lt;rusty&gt;</span> Someone remind me of the purpose of this?  Is it more a "why not, it's free?"
<a name="l-100"></a><span class="tm">20:43:50</span><span class="nk"> &lt;BlueMatt&gt;</span> yea, basically, though marginally increases the cost of dos'ing a channel so you have to actually put up non-dust values
<a name="l-101"></a><span class="tm">20:44:03</span><span class="nk"> &lt;roasbeef&gt;</span> basically that someone can add dust and make your channel less useful
<a name="l-102"></a><span class="tm">20:44:21</span><span class="nk"> &lt;lnd-bot&gt;</span> [13lightning-rfc] 15TheBlueMatt opened pull request #876: Concretize Output Ordering to be less confusing (06master...062021-05-no-bip69) 02https://github.com/lightningnetwork/lightning-rfc/pull/876
<a name="l-103"></a><span class="tm">20:45:07</span><span class="nk"> &lt;rusty&gt;</span> Well, since dust levels don't have to be the same on both sides, this proposal is insufficient?
<a name="l-104"></a><span class="tm">20:45:20</span><span class="nk"> &lt;BlueMatt&gt;</span> tbh i didnt read the proposed text lol
<a name="l-105"></a><span class="tm">20:45:23</span><span class="nk"> &lt;rusty&gt;</span> I think it has to be "if either side considers it non-dust, we count it"?
<a name="l-106"></a><span class="tm">20:45:33</span><span class="nk"> &lt;BlueMatt&gt;</span> yea, probably what you said rusty
<a name="l-107"></a><span class="tm">20:46:21</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">rusty:</span> well the dust is already asymmetric, so I imagine this would be as well?
<a name="l-108"></a><span class="tm">20:46:54</span><span class="nk"> &lt;roasbeef&gt;</span> at a high level is proposes not counting dust htlcs to the max htlc limit
<a name="l-109"></a><span class="tm">20:47:09</span><span class="nk"> &lt;roasbeef&gt;</span> which would then be clamped only by the max dust settings
<a name="l-110"></a><span class="tm">20:47:17</span><span class="nk"> &lt;roasbeef&gt;</span> tho maybe just two limits a better?
<a name="l-111"></a><span class="tm">20:48:04</span><span class="nk"> &lt;BlueMatt&gt;</span> but if you have one side that adds a billion dust outputs but they aren't dust for the other side, then the other side cant broadcast a transaction cause it has a billion outputs?
<a name="l-112"></a><span class="tm">20:48:15</span><span class="nk"> &lt;rusty&gt;</span> Well, I guess if you propose 1M dust htlcs which are not dust for yourself, that's on you?
<a name="l-113"></a><span class="tm">20:48:17</span><span class="nk"> &lt;BlueMatt&gt;</span> cause the dust limit of the broadcaster applies to all the htlcs not just the broadcaster's htlcs
<a name="l-114"></a><span class="tm">20:48:33</span><span class="nk"> &lt;BlueMatt&gt;</span> wouldnt you be able to prevent someone from broadcasting their commitment tx?
<a name="l-115"></a><span class="tm">20:48:49</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> the proposal says you can't add an htlc if it would go over the max for the *other* side.
<a name="l-116"></a><span class="tm">20:48:55</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">BlueMatt:</span> each side says what their dust limit is tho
<a name="l-117"></a><span class="tm">20:49:05</span><span class="nk"> &lt;joost_&gt;</span> hi all. won't this open up a new vector where an attacker can send indeed a billion htlcs along the same (26 hop) route into the network? it won't weigh down on the commit txes, but it does on processing
<a name="l-118"></a><span class="tm">20:49:06</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> so I think you can only shoot yourself.
<a name="l-119"></a><span class="tm">20:49:24</span><span class="nk"> &lt;joost_&gt;</span> (1 msat htlcs)
<a name="l-120"></a><span class="tm">20:49:30</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">joost_:</span> yeh so there needs to be another count clamp on dust htlcs themselves
<a name="l-121"></a><span class="tm">20:49:50</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">joost_:</span> I dont see why that needs a separate limit? you already have fees and its no different than any other htlc
<a name="l-122"></a><span class="tm">20:50:03</span><span class="nk"> &lt;roasbeef&gt;</span> I think the ML post has more context here also
<a name="l-123"></a><span class="tm">20:50:23</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> if you set fees to zero you get this problem though, I guess.
<a name="l-124"></a><span class="tm">20:50:35</span><span class="nk"> &lt;roasbeef&gt;</span> I g2g in 10
<a name="l-125"></a><span class="tm">20:50:40</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> I mean you get that problem if you send a bajillion 1sat htlcs too....
<a name="l-126"></a><span class="tm">20:51:41</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> ok, I think I agree that as worded you can only shoot yourself. I'd propose mentioning that you can shoot yourself in the spec.
<a name="l-127"></a><span class="tm">20:52:09</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">BlueMatt:</span> another limit since those would all be dust, you need to clamp dust and non dust in total count of each
<a name="l-128"></a><span class="tm">20:52:30</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> why
<a name="l-129"></a><span class="tm">20:52:41</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> what is wrong with having a ton of dust outputs?
<a name="l-130"></a><span class="tm">20:52:47</span><span class="nk"> &lt;roasbeef&gt;</span> that PR says don't count dust towards the max htlc number anymore
<a name="l-131"></a><span class="tm">20:52:50</span><span class="nk"> &lt;rusty&gt;</span> Thinking more, I'm not sure what the actual CPU limitation BigNum dust HTLCs would be.  I suspect we may have some O(N^2) somewhere in our tx construction code maybe?
<a name="l-132"></a><span class="tm">20:52:56</span><span class="nk"> &lt;roasbeef&gt;</span> what stops a commitment from being fully dusted if that isn't there BlueMatt ?
<a name="l-133"></a><span class="tm">20:53:04</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> it doesnt feed into tx construction, though?
<a name="l-134"></a><span class="tm">20:53:16</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> you dont have to send signatures for a dust htlc, too!
<a name="l-135"></a><span class="tm">20:53:20</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> we discard them though, and turn them into fees.
<a name="l-136"></a><span class="tm">20:53:26</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> you already have a limit on the total in-flight?
<a name="l-137"></a><span class="tm">20:53:30</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> I think that's O(N).
<a name="l-138"></a><span class="tm">20:53:40</span><span class="nk"> &lt;roasbeef&gt;</span> <span class="hi">BlueMatt:</span> that PR says you don't count dust towards total in flight anymore
<a name="l-139"></a><span class="tm">20:54:00</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">roasbeef:</span> htlc count, I assumed we'd still count them towards value-in-flight
<a name="l-140"></a><span class="tm">20:54:15</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> yeah, but a 1 BTC channel can easily have &gt; 10M dust htlcs.
<a name="l-141"></a><span class="tm">20:54:21</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> right, would need to read code carefully, but i was assuming signature creation/checking would basically dwarf you in any case
<a name="l-142"></a><span class="tm">20:54:53</span><span class="nk"> &lt;BlueMatt&gt;</span> ie even one signature could dwarf 1M simple ifs in a for loop....depending on how the code is
<a name="l-143"></a><span class="tm">20:54:59</span><span class="nk"> &lt;rusty&gt;</span> <span class="hi">BlueMatt:</span> I'd like to benchmark, just to be sure.  We never bothered optimizations for &lt; 1000 htlcs as we have now.
<a name="l-144"></a><span class="tm">20:55:05</span><span class="nk"> &lt;BlueMatt&gt;</span> yes, agreed
<a name="l-145"></a><span class="tm">20:55:41</span><span class="nk"> &lt;rusty&gt;</span> OK, so next step is to turn it into actual patch with caveats mentioned here?
<a name="l-146"></a><span class="tm">20:55:46</span><span class="nk"> &lt;BlueMatt&gt;</span> +1
<a name="l-147"></a><span class="tm">20:55:56</span><span class="nk"> &lt;roasbeef&gt;</span> i'll ping eugene about that
<a name="l-148"></a><span class="tm">20:56:06</span><span class="nk"> &lt;roasbeef&gt;</span> (crypt-iq)
<a name="l-149"></a><span class="tm">20:56:07</span><span class="nk"> &lt;rusty&gt;</span> <span class="cmd">#action </span><span class="cmdline">rusty to assign feature bit for #873</span>
<a name="l-150"></a><span class="tm">20:56:11</span><span class="nk"> &lt;niftynei&gt;</span> seems like setting a "max fees from dust" limit might be a better way to approach this than a cap on the num of 'dust htlcs'
<a name="l-151"></a><span class="tm">20:56:16</span><span class="nk"> &lt;BlueMatt&gt;</span> let me paste this on the issue
<a name="l-152"></a><span class="tm">20:56:23</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">niftynei:</span> sgtm
<a name="l-153"></a><span class="tm">20:57:00</span><span class="nk"> &lt;rusty&gt;</span> OK, I say we end the meeting early, rather than trying to squeeze something in 4 minutes?
<a name="l-154"></a><span class="tm">20:57:18</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">niftynei:</span> its already hard to pick appropriate dust limits trying to munge a "max fees from dust" limit out of it. having an explicit "max fees from dust" seems strictly better than today in any case.
<a name="l-155"></a><span class="tm">20:57:22</span><span class="nk"> &lt;BlueMatt&gt;</span> <span class="hi">rusty:</span> ack
<a name="l-156"></a><span class="tm">20:58:01</span><span class="nk"> &lt;rusty&gt;</span> <span class="cmd">#endmeting</span><span class="cmdline"></span>
<a name="l-157"></a><span class="tm">20:58:06</span><span class="nk"> &lt;rusty&gt;</span> <span class="cmd">#endmeeting</span><span class="cmdline"></span></pre>
</body></html>
