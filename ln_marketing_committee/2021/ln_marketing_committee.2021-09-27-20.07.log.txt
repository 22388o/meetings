20:07:38 <ariard> #startmeeting LN marketing committee
20:07:38 <lndev-bot> Meeting started Mon Sep 27 20:07:38 2021 UTC and is due to finish in 60 minutes.  The chair is ariard. Information about MeetBot at http://wiki.debian.org/MeetBot.
20:07:38 <lndev-bot> Useful Commands: #action #agreed #help #info #idea #link #topic #startvote.
20:07:38 <lndev-bot> The meeting name has been set to 'ln_marketing_committee'
20:07:40 <t-bast> Please diverge from the item order in the issue!
20:11:41 <ariard> mschmoock: iiuc it's either #911 or #917 ?
20:11:42 <BlueMatt> I'm game for either. networking is hard, lots of issues with any option.
20:12:00 <mschmoock> well, lot of back and forth. I think 917 is better
20:12:00 <BlueMatt> honestly could do both, but at least 917 is probably a better first-pass imo if only because it means less setup on the admin end
20:12:27 <t-bast> I'd slightly prefer avoiding using DNS explicitly, so #917 for me, but I don't have a strong NACK on #911 though
20:12:29 <BlueMatt> t-bast: had said concept ack on 917 and said he was gonna start coding :)
20:12:39 <mschmoock> is there any usage of #917 when using IPv6 addresses ? Is there something like IPv6 NAT??
20:12:53 <BlueMatt> mschmoock: yes, there is address mapping in v6
20:13:01 <BlueMatt> so i think it may be useful for v6 as well
20:13:06 <mschmoock> good
20:13:07 <BlueMatt> its probably also useful for tor
20:13:23 <BlueMatt> though somewhat less so
20:13:26 <t-bast> Can you detail why it's useful for tor?
20:14:09 <t-bast> To check the bridges used (bridge isn't the right term, is it)?
20:14:13 <BlueMatt> just means a node can auto-discover its addresses with zero configuration. eg if you configure tor but forget to configure your ln node, and then tell someone to connect to you on tor, *boom* your ln node is now configured
20:14:25 <BlueMatt> which seems nifty, but, indeed, isnt exactly a headline features
20:14:42 <t-bast> Oh ok, so you'd really put the onion address in there
20:15:11 <BlueMatt> yea, just putting "I think I'm connecting to 10.X" isnt exactly useful :)
20:15:51 <cdecker[m]> Or Tor will return 127.0.0.1 always :-)
20:16:01 <BlueMatt> right or that
20:16:01 <mschmoock> Okay, when we discover some new address supposedly of our node, whats the best strategy to use that? BlueMatt mentioned just to broadcast 'all' (maybe upt to a limit)
20:16:18 <cdecker[m]> So needs to filter local addrs
20:16:20 <BlueMatt> yea, i dunno, doesn't need to be in the spec imo.
20:16:29 <BlueMatt> just "dont include local addresses" could be mentioned
20:16:48 <BlueMatt> but nodes can figure out for themselves how they want to use the addresses provided, including them all is cool, trying to filter is cool too.
20:16:57 <roasbeef> ye re #910, I think we just need more impls, we're working on one in the background, but also considering how the pubkey based routing proposal would also serve to simplify certain aspects of it
20:17:36 <roasbeef> made a comment on #917 that it doesn't really seem to be an alternative to #911: https://github.com/lightningnetwork/lightning-rfc/pull/917#issuecomment-928235635
20:18:18 <mschmoock> BlueMatt: by "dont iclude local addresses"  you mean more than the note about pricate addresses I already added?
20:18:34 <BlueMatt> mschmoock: yes, but I hadnt realized you'd done that already :)
20:18:44 <mschmoock> k
20:18:47 <t-bast> roasbeef: true, both could potentially be used for different purposes
20:19:10 <roasbeef> t-bast: yeh the DNS thing seems really useful for ppl managing automated fleets of nodes
20:19:17 <rusty> 911/917: Hmm, you'd need to open a port either way.  But I agree it's not really an alternative; people *do* run dyndns, and that works, using your peers to get your current address; it's probably harmless to do, but it's a bit weird.
20:19:28 <mschmoock> I have 911 half implemented. 917 is easy
20:19:30 <roasbeef> rn we have a setting where lnd will hit a DNS record and then advertise the new IP addr as a workaround, since we don't support DNS names within the node_ann
20:19:44 <roasbeef> since when we spin up a new node, we may not yet know what the reachable IP of it is gonna be
20:19:48 <cdecker[m]> We should mkae sure this doesnt end up with all NATed and unconnectable node anns
20:20:23 <BlueMatt> rusty: fwiw, bitcoin core uses "what my peer told me my ip address is" for advertisements to some extent and it works reasonably. of course its different in core cause you don't care if its "my" ip vs "a node's ip" but still
20:20:47 <BlueMatt> cdecker[m]: presumably ignoring local addresses suffices?
20:21:03 <roasbeef> cdecker[m]: things are kiiiinda like that rn w/ how many nodes are tor only these days
20:21:29 <cdecker[m]> No if you tell me I'm seeing you as x.y.z and then you use that in your ann it still means you're unrachable
20:21:50 <rusty> We already have a local addr filter for our auto-announce stuff, so this is pretty easy.  Oh, BTW we're moving to 15-45 second pings for all connections in next release, because ppl were complaining about Tor circuits breaking and them only finding out when trying to send an HTLC...
20:22:17 <BlueMatt> we tried to move to 5 second pings, now all my lnd peers drop off regularly
20:22:17 <BlueMatt> but c-lightning peers seem totally fine
20:22:31 <BlueMatt> but I think we'll stick with 5 second pings, tbh
20:22:33 <rusty> BlueMatt spec says once per minute, IIRC.
20:22:38 <mschmoock> theres some spam limit on pings...
20:22:47 <BlueMatt> i know it does, but we had the same problem as you, and even worse on mobile cause of ios limits....
20:22:56 <rusty> - SHOULD NOT send `ping` messages more often than once every 30 seconds.
20:23:13 <BlueMatt> maybe we should drop that, that's not really practical on mobile, especially ios
20:23:22 <mschmoock> (and should not send another ping when the pong has not been received)
20:23:23 <BlueMatt> I'll follow up, I had forgotten that was there, thanks
20:23:32 <rusty> BlueMatt: +1
20:23:35 <BlueMatt> mschmoock: well that's easy, we just disconnect if the pong wasn't received!
20:23:58 <mschmoock> sure
20:24:18 <BlueMatt> anyway, seems we're done with 917?
20:24:20 <BlueMatt> next topic?
20:24:22 <mschmoock> just wanted to note repreating a ping may result in spam on the other side when there was TCP jam
20:24:24 <ariard> oky, so let's end up with both 911 and 917 as it offers more flexibility to node operators?
20:25:00 <BlueMatt> pending further discussion and implementaiton of course, but, I'm fine with both.
20:25:08 <mschmoock> we could prioritize 917 as its simpler
20:25:15 <t-bast> ACK
20:25:17 <mschmoock> well both are simple
20:25:37 <ariard> #topic #912
20:25:48 <roasbeef> BlueMatt: yeh I saw that issue, we had really low values there, but then raied it a ton, once we started testing from diff locations, throw in tor/mobile, etc, etc
20:25:56 <cdecker[m]> ACK, it also takes the longest to bear fruit
20:26:01 <roasbeef> generally the timeouts prob need to be longer than you anticipate is what we've leanred over the years
20:26:30 <ariard> what's the state of ML discussion on 912 ?
20:26:32 <BlueMatt> roasbeef: I dont think I filed an issue? but, in my case its not a tor or mobile issue, its just lnd ignoring pings, cause its clearnet and actual pings are fine
20:26:44 <BlueMatt> or lnd being blocked doing other things, i dunno
20:26:56 <roasbeef> there was some other issue on teh RL repo, where someone found that RL was disconnecting from lnd peers due to some like queueing thing...would need to go find it
20:27:40 <roasbeef> we respond to pings right away and don't add them to some processing queue, I think we was something related to like initial graph download and pings at the same time or the idle conn timer, can go find the link later
20:27:49 <t-bast> There is more rationale about #912 on the ML, Joost clearly laid out how that can be used to create invoices without storing anything until it's paid
20:27:53 <BlueMatt> roasbeef: https://github.com/lightningnetwork/lnd/issues/4006 you mean? that's not an RL bug, but we've now got explicit code to handle it just like c-lightning does....it'd be really nice if y'all fixed it to be spec-compliant
20:28:11 <roasbeef> BlueMatt: no that's not it
20:28:35 <BlueMatt> roasbeef: we dont (materially) queue graph messages or pings? unless y'all just dump the whole graph into the send queue? In any case, I do not see this issue with c-lightning
20:28:42 <BlueMatt> and its rare enough that I dont care much
20:28:54 <ariard> t-bast: and you pointed it's coming for free with route blinding ?
20:28:56 <t-bast> #link https://lists.linuxfoundation.org/pipermail/lightning-dev/2021-September/003236.html